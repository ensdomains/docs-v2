(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[569],{208:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/ensip/7",function(){return n(8577)}])},8577:function(e,s,n){"use strict";n.r(s),n.d(s,{__N_SSG:function(){return r}});var o=n(1527),a=n(313);function t(e){let s=Object.assign({h1:"h1",table:"table",thead:"thead",tr:"tr",th:"th",strong:"strong",tbody:"tbody",td:"td",h2:"h2",p:"p",code:"code",a:"a",pre:"pre",h3:"h3",ul:"ul",li:"li"},(0,a.ah)(),e.components);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(s.h1,{children:"ENSIP-7: Contenthash field"}),"\n",(0,o.jsxs)(s.table,{children:[(0,o.jsx)(s.thead,{children:(0,o.jsxs)(s.tr,{children:[(0,o.jsx)(s.th,{children:(0,o.jsx)(s.strong,{children:"Author"})}),(0,o.jsx)(s.th,{children:"Dean Eigenmann, Nick Johnson"})]})}),(0,o.jsxs)(s.tbody,{children:[(0,o.jsxs)(s.tr,{children:[(0,o.jsx)(s.td,{children:(0,o.jsx)(s.strong,{children:"Status"})}),(0,o.jsx)(s.td,{children:"Final"})]}),(0,o.jsxs)(s.tr,{children:[(0,o.jsx)(s.td,{children:(0,o.jsx)(s.strong,{children:"Created"})}),(0,o.jsx)(s.td,{children:"2018-11-13"})]})]})]}),"\n",(0,o.jsx)(s.h2,{id:"abstract",children:"Abstract"}),"\n",(0,o.jsxs)(s.p,{children:["This ENSIP introduces the new ",(0,o.jsx)(s.code,{children:"contenthash"})," field for ENS resolvers, allowing for a better defined system of mapping names to network and content addresses. Additionally the ",(0,o.jsx)(s.code,{children:"content"})," and ",(0,o.jsx)(s.code,{children:"multihash"})," fields are deprecated."]}),"\n",(0,o.jsx)(s.h2,{id:"motivation",children:"Motivation"}),"\n",(0,o.jsxs)(s.p,{children:["Multiple applications including ",(0,o.jsx)(s.a,{href:"https://metamask.io",children:"Metamask"})," and mobile clients such as ",(0,o.jsx)(s.a,{href:"https://status.im",children:"Status"})," have begun resolving ENS names to content hosted on distributed systems such as ",(0,o.jsx)(s.a,{href:"https://ipfs.io",children:"IPFS"})," and ",(0,o.jsx)(s.a,{href:"https://swarm-guide.readthedocs.io",children:"Swarm"}),". Due to the various ways content can be stored and addressed, a standard is required so these applications know how to resolve names and that domain owners know how their content will be resolved."]}),"\n",(0,o.jsxs)(s.p,{children:["The ",(0,o.jsx)(s.code,{children:"contenthash"})," field allows for easy specification of network and content addresses in ENS."]}),"\n",(0,o.jsx)(s.h2,{id:"specification",children:"Specification"}),"\n",(0,o.jsxs)(s.p,{children:["The field ",(0,o.jsx)(s.code,{children:"contenthash"})," is introduced, which permits a wide range of protocols to be supported by ENS names. Resolvers supporting this field MUST return ",(0,o.jsx)(s.code,{children:"true"})," when the ",(0,o.jsx)(s.code,{children:"supportsInterface"})," function is called with argument ",(0,o.jsx)(s.code,{children:"0xbc1c58d1"}),"."]}),"\n",(0,o.jsxs)(s.p,{children:["The fields ",(0,o.jsx)(s.code,{children:"content"})," and ",(0,o.jsx)(s.code,{children:"multihash"})," are deprecated."]}),"\n",(0,o.jsxs)(s.p,{children:["The value returned by ",(0,o.jsx)(s.code,{children:"contenthash"})," MUST be represented as a machine-readable ",(0,o.jsx)(s.a,{href:"https://github.com/multiformats/multicodec",children:"multicodec"}),". The format is specified as follows:"]}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"<protoCode uvarint><value []byte>\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)">protoCode uvarint</span><span style="color: var(--shiki-token-keyword)">&gt;&lt;</span><span style="color: var(--shiki-color-text)">value []</span><span style="color: var(--shiki-token-keyword)">byte&gt;</span>'})}),"\n",(0,o.jsxs)(s.p,{children:["protoCodes and their meanings are specified in the ",(0,o.jsx)(s.a,{href:"https://github.com/multiformats/multicodec",children:"multiformats/multicodec"})," repository."]}),"\n",(0,o.jsxs)(s.p,{children:["The encoding of the value depends on the content type specified by the protoCode. Values with protocodes of 0xe3 and 0xe4 represent IPFS and Swarm content; these values are encoded as v1 ",(0,o.jsx)(s.a,{href:"https://github.com/multiformats/cid",children:"CIDs"})," without a base prefix, meaning their value is formatted as follows:"]}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"<protoCode uvarint><cid-version><multicodec-content-type><multihash-content-address>\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)">protoCode uvarint</span><span style="color: var(--shiki-token-keyword)">&gt;&lt;</span><span style="color: var(--shiki-color-text)">cid</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">version</span><span style="color: var(--shiki-token-keyword)">&gt;&lt;</span><span style="color: var(--shiki-color-text)">multicodec</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">content</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">type</span><span style="color: var(--shiki-token-keyword)">&gt;&lt;</span><span style="color: var(--shiki-color-text)">multihash</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">content</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">address</span><span style="color: var(--shiki-token-keyword)">&gt;</span>'})}),"\n",(0,o.jsxs)(s.p,{children:["When resolving a ",(0,o.jsx)(s.code,{children:"contenthash"}),", applications MUST use the protocol code to determine what type of address is encoded, and resolve the address appropriately for that protocol, if supported."]}),"\n",(0,o.jsx)(s.h3,{children:"Example"}),"\n",(0,o.jsx)(s.p,{children:(0,o.jsx)(s.strong,{children:"IPFS"})}),"\n",(0,o.jsx)(s.p,{children:"Input data:"}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"storage system: IPFS (0xe3)\nCID version: 1 (0x01)\ncontent type: dag-pb (0x70)\nhash function: sha2-256 (0x12)\nhash length: 32 bytes (0x20)\nhash: 29f2d17be6139079dc48696d1f582a8530eb9805b561eda517e22a892c7e3f1f\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-color-text)">storage system: IPFS (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">e3</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">CID version: </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">01</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">content type: dag</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">pb (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">70</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">hash function: sha2</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-token-constant)">256</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">12</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">hash length: </span><span style="color: var(--shiki-token-constant)">32</span><span style="color: var(--shiki-color-text)"> bytes (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">20</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">hash: 29f2d17be6139079dc48696d1f582a8530eb9805b561eda517e22a892c7e3f1f</span>'})}),"\n",(0,o.jsx)(s.p,{children:"Binary format:"}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"0xe3010170122029f2d17be6139079dc48696d1f582a8530eb9805b561eda517e22a892c7e3f1f\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">e3010170122029f2d17be6139079dc48696d1f582a8530eb9805b561eda517e22a892c7e3f1f</span>'})}),"\n",(0,o.jsx)(s.p,{children:"Text format:"}),"\n",(0,o.jsx)(s.pre,{language:"txt",code:"ipfs://QmRAQB6YaCyidP37UdDnjFY5vQuiBrcqdyoW1CuDgwxkD4\n",children:(0,o.jsx)(s.code,{className:"language-txt",children:'<span style="color: undefined">ipfs://QmRAQB6YaCyidP37UdDnjFY5vQuiBrcqdyoW1CuDgwxkD4</span>\n<span style="color: undefined"></span>'})}),"\n",(0,o.jsx)(s.h3,{children:"Swarm"}),"\n",(0,o.jsx)(s.p,{children:"Input data:"}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"storage system: Swarm (0xe4)\nCID version: 1 (0x01)\ncontent type: swarm-manifest (0xfa)\nhash function: keccak256 (0x1b)\nhash length: 32 bytes (0x20)\nhash: d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-color-text)">storage system: Swarm (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">e4</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">CID version: </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">01</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">content type: swarm</span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)">manifest (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">fa</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">hash function: keccak256 (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">1b</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">hash length: </span><span style="color: var(--shiki-token-constant)">32</span><span style="color: var(--shiki-color-text)"> bytes (</span><span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">20</span><span style="color: var(--shiki-color-text)">)</span>\n<span style="color: var(--shiki-color-text)">hash: d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162</span>'})}),"\n",(0,o.jsx)(s.p,{children:"Binary format:"}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"0xe40101fa011b20d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-token-keyword)">0x</span><span style="color: var(--shiki-token-constant)">e40101fa011b20d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162</span>'})}),"\n",(0,o.jsx)(s.p,{children:"Text format:"}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"bzz://d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-color-text)">bzz:</span><span style="color: var(--shiki-token-comment)">//d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162</span>'})}),"\n",(0,o.jsx)(s.p,{children:"Example usage with swarm hash:"}),"\n",(0,o.jsx)(s.pre,{language:"go",code:"$ swarm hash ens contenthash d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162                                 \n> e40101fa011b20d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162\n",children:(0,o.jsx)(s.code,{className:"language-go",children:'<span style="color: var(--shiki-color-text)">$ swarm hash ens contenthash d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162                                 </span>\n<span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)"> e40101fa011b20d1de9994b4d039f6548d191eb26786769f580809256b4685ef316805265ea162</span>'})}),"\n",(0,o.jsx)(s.h3,{children:"Fallback"}),"\n",(0,o.jsxs)(s.p,{children:["In order to support names that have an IPFS or Swarm hash in their ",(0,o.jsx)(s.code,{children:"content"})," field, a grace period MUST be implemented offering those name holders time to update their names. If a resolver does not support the ",(0,o.jsx)(s.code,{children:"multihash"})," interface, it MUST be checked whether they support the ",(0,o.jsx)(s.code,{children:"content"})," interface. If they do, the value of that field SHOULD be treated in a context dependent fashion and resolved. This condition MUST be enforced until at least March 31st, 2019."]}),"\n",(0,o.jsx)(s.h3,{children:"Implementation"}),"\n",(0,o.jsxs)(s.p,{children:["To support ",(0,o.jsx)(s.code,{children:"contenthash"}),", a new resolver has been developed and can be found ",(0,o.jsx)(s.a,{href:"https://github.com/ensdomains/resolvers/blob/master/contracts/PublicResolver.sol",children:"here"}),", you can also find this smart contract deployed on:"]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsxs)(s.li,{children:["Mainnet : ",(0,o.jsx)(s.a,{href:"https://etherscan.io/address/0xd3ddccdd3b25a8a7423b5bee360a42146eb4baf3",children:"0xd3ddccdd3b25a8a7423b5bee360a42146eb4baf3"})]}),"\n",(0,o.jsxs)(s.li,{children:["Ropsten : ",(0,o.jsx)(s.a,{href:"https://ropsten.etherscan.io/address/0xde469c7106a9fbc3fb98912bb00be983a89bddca",children:"0xde469c7106a9fbc3fb98912bb00be983a89bddca"})]}),"\n"]}),"\n",(0,o.jsxs)(s.p,{children:["There are also implementations in multiple languages to encode and decode ",(0,o.jsx)(s.code,{children:"contenthash"}),":"]}),"\n",(0,o.jsxs)(s.ul,{children:["\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"https://github.com/pldespaigne/content-hash",children:"JavaScript"})}),"\n",(0,o.jsx)(s.li,{children:(0,o.jsx)(s.a,{href:"https://github.com/filips123/ContentHashPy",children:"Python"})}),"\n"]}),"\n",(0,o.jsx)(s.h2,{id:"copyright",children:"Copyright"}),"\n",(0,o.jsxs)(s.p,{children:["Copyright and related rights waived via ",(0,o.jsx)(s.a,{href:"https://creativecommons.org/publicdomain/zero/1.0/",children:"CC0"}),"."]})]})}var r=!0;s.default=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:s}=Object.assign({},(0,a.ah)(),e.components);return s?(0,o.jsx)(s,Object.assign({},e,{children:(0,o.jsx)(t,e)})):t(e)}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=208)}),_N_E=e.O()}]);