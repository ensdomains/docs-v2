(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4301],{6048:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dapp-developer-guide/ens-as-nft",function(){return r(3884)}])},3884:function(e,n,r){"use strict";r.r(n);var t=r(4637),a=r(6988),o=r(1177),s=r(2370),i=function(e){return(0,o.withSSG)((0,a.Z)({filename:"ens-as-nft.mdx",route:"/dapp-developer-guide/ens-as-nft",meta:{},pageMap:[{name:"README",route:"/README"},{name:"SUMMARY",route:"/SUMMARY"},{name:"bug-bounty-program",route:"/bug-bounty-program"},{name:"contract-api-reference",children:[{name:"ENS-Contracts-Overview",route:"/contract-api-reference/ENS-Contracts-Overview"},{name:"dns-registrar",route:"/contract-api-reference/dns-registrar"},{name:"ens",route:"/contract-api-reference/ens",frontMatter:{description:"The ENS registry."}},{name:"eth-permanent-registrar",children:[{name:"README",route:"/contract-api-reference/eth-permanent-registrar/README"},{name:"controller",route:"/contract-api-reference/eth-permanent-registrar/controller"},{name:"registrar",route:"/contract-api-reference/eth-permanent-registrar/registrar"}],route:"/contract-api-reference/eth-permanent-registrar"},{name:"name-processing",route:"/contract-api-reference/name-processing",frontMatter:{description:"Describes how to normalize and hash ENS names."}},{name:"publicresolver",route:"/contract-api-reference/publicresolver",frontMatter:{description:"The default public resolver."}},{name:"reverseregistrar",route:"/contract-api-reference/reverseregistrar",frontMatter:{description:"The registrar responsible for managing reverse resolution via the .addr.reverse special-purpose TLD."}},{name:"testregistrar",route:"/contract-api-reference/testregistrar"}],route:"/contract-api-reference"},{name:"contract-developer-guide",children:[{name:"resolving-names-on-chain",route:"/contract-developer-guide/resolving-names-on-chain"},{name:"writing-a-registrar",route:"/contract-developer-guide/writing-a-registrar"},{name:"writing-a-resolver",route:"/contract-developer-guide/writing-a-resolver"}],route:"/contract-developer-guide"},{name:"dapp-developer-guide",children:[{name:"ens-as-nft",route:"/dapp-developer-guide/ens-as-nft"},{name:"ens-enabling-your-dapp",route:"/dapp-developer-guide/ens-enabling-your-dapp"},{name:"ens-l2-offchain",route:"/dapp-developer-guide/ens-l2-offchain"},{name:"ens-libraries",route:"/dapp-developer-guide/ens-libraries"},{name:"front-end-design-guidelines",route:"/dapp-developer-guide/front-end-design-guidelines",frontMatter:{description:"ENS is a tool to simplify the experience for your users. Here are a series of guidelines and tools that will help you make design choices and implement the best ENS user experience."}},{name:"managing-names",route:"/dapp-developer-guide/managing-names"},{name:"registering-and-renewing-names",route:"/dapp-developer-guide/registering-and-renewing-names"},{name:"resolving-names",route:"/dapp-developer-guide/resolving-names"},{name:"working-with-ens",route:"/dapp-developer-guide/working-with-ens"}],route:"/dapp-developer-guide"},{name:"deploying-ens-on-a-private-chain",route:"/deploying-ens-on-a-private-chain"},{name:"developer",children:[{name:"index",route:"/developer"},{name:"meta.json",meta:{index:{title:"Developer Documentation",type:"docs",theme:{}}},locale:"en-US"}],route:"/developer"},{name:"dns-registrar-guide",route:"/dns-registrar-guide"},{name:"ens-deployments",route:"/ens-deployments"},{name:"ens-improvement-proposals",children:[{name:"README",route:"/ens-improvement-proposals/README",frontMatter:{description:"Standards documentation describing the ENS protocol"}},{name:"ensip-1-ens",route:"/ens-improvement-proposals/ensip-1-ens",frontMatter:{description:"Documentation of the basic ENS protocol (formerly EIP-137)."}},{name:"ensip-10-wildcard-resolution",route:"/ens-improvement-proposals/ensip-10-wildcard-resolution",frontMatter:{description:"Provides a mechanism to support wildcard resolution of ENS names (formerly EIP-2544)."}},{name:"ensip-11-evmchain-address-resolution",route:"/ens-improvement-proposals/ensip-11-evmchain-address-resolution",frontMatter:{description:"Introduces coinType for EVM compatible chains (amending ENSIP9)."}},{name:"ensip-12-avatar-text-records",route:"/ens-improvement-proposals/ensip-12-avatar-text-records",frontMatter:{description:"A standard for storage of the avatar text record in ENS."}},{name:"ensip-2-initial-hash-registrar",route:"/ens-improvement-proposals/ensip-2-initial-hash-registrar",frontMatter:{description:"Describes the hash registrar initially used to register ENS .eth domains (formerly EIP-162)."}},{name:"ensip-3-reverse-resolution",route:"/ens-improvement-proposals/ensip-3-reverse-resolution",frontMatter:{description:"Specifies a TLD, registrar, and resolver interface for reverse resolution of Ethereum addresses using ENS (formerly EIP-181)."}},{name:"ensip-4-support-for-contract-abis",route:"/ens-improvement-proposals/ensip-4-support-for-contract-abis",frontMatter:{description:"A mechanism for storing ABI definitions in ENS, for easy lookup of contract interfaces by callers (formerly EIP-205)."}},{name:"ensip-5-text-records",route:"/ens-improvement-proposals/ensip-5-text-records",frontMatter:{description:"A standard for storage of text records in ENS (formerly EIP-634)."}},{name:"ensip-6-dns-in-ens",route:"/ens-improvement-proposals/ensip-6-dns-in-ens",frontMatter:{description:"Defines a resolver profile for ENS that provides features for storage and lookup of DNS records (formerly EIP-1185)."}},{name:"ensip-7-contenthash-field",route:"/ens-improvement-proposals/ensip-7-contenthash-field",frontMatter:{description:"Introduces a field for storing content addresses and hashes in ENS (formerly EIP-1577)."}},{name:"ensip-8-interface-discovery",route:"/ens-improvement-proposals/ensip-8-interface-discovery",frontMatter:{description:"Defines a method of associating contract interfaces with ENS names and addresses, and of discovering those interfaces (formerly EIP-1844)."}},{name:"ensip-9-multichain-address-resolution",route:"/ens-improvement-proposals/ensip-9-multichain-address-resolution",frontMatter:{description:"Introduces new overloads for the `addr` field for ENS resolvers, which permit resolution of addresses for other blockchains via ENS (formerly EIP-2304)."}}],route:"/ens-improvement-proposals"},{name:"ens-migration-february-2020",children:[{name:"guide-for-dapp-developers",route:"/ens-migration-february-2020/guide-for-dapp-developers"},{name:"technical-description",route:"/ens-migration-february-2020/technical-description"}],route:"/ens-migration-february-2020"},{name:"frequently-asked-questions",route:"/frequently-asked-questions"},{name:"governance",children:[{name:"index",route:"/governance"},{name:"meta.json",meta:{index:{title:"Governance Documentation",type:"docs",theme:{}}},locale:"en-US"}],route:"/governance"},{name:"index",route:"/",frontMatter:{title:"Welcome"}},{name:"meta.json",meta:{index:{title:"Introduction",type:"docs",hidden:!0,theme:{}},governance:{title:"Governance",type:"nav"},user:{title:"User",type:"nav"},developer:{title:"Developer",type:"nav"},technical:{title:"Technical",type:"nav"}},locale:"en-US"},{name:"permanent-registrar-faq",route:"/permanent-registrar-faq"},{name:"technical",children:[{name:"index",route:"/technical"},{name:"meta.json",meta:{index:{title:"Technical Documentation",type:"docs",theme:{}}},locale:"en-US"}],route:"/technical"},{name:"terminology",route:"/terminology"},{name:"user",children:[{name:"index",route:"/user"},{name:"meta.json",meta:{index:{title:"User Documentation",type:"docs",theme:{}}},locale:"en-US"}],route:"/user"}]},s.Z))(e)};function c(e){var n=Object.assign({h1:"h1",p:"p",a:"a",h2:"h2",code:"code",pre:"pre",ol:"ol",li:"li"},e.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{children:"ENS as NFT"}),"\n",(0,t.jsxs)(n.p,{children:["When ENS .eth registrar migrated in May 2019, the .eth registrar became an ",(0,t.jsx)(n.a,{href:"https://github.com/ensdomains/ens/blob/master/docs/ethregistrar.rst#id3",children:"ERC721"})," compliant non-fungible token contract, meaning that .eth registrations can be transferred in the same fashion as other NFTs."]}),"\n",(0,t.jsx)(n.h2,{children:"Deriving tokenId from ENS name"}),"\n",(0,t.jsxs)(n.p,{children:["The tokenId of ENS name is simply the uint256 representation of the hash of the label (",(0,t.jsx)(n.code,{children:"vitalik"})," for ",(0,t.jsx)(n.code,{children:"vitalik.eth"}),")."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const ethers = require('ethers')\nconst BigNumber = ethers.BigNumber\nconst utils = ethers.utils\nconst name = 'vitalik'\nconst labelHash = utils.keccak256(utils.toUtf8Bytes('vitalik'))\nconst tokenId = BigNumber.from(labelHash).toString()\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In the example above,",(0,t.jsx)(n.a,{href:"https://opensea.io/assets/0x57f1887a8bf19b14fc0df6fd9b2acc9af147ea85/79233663829379634837589865448569342784712482819484549289560981379859480642508",children:(0,t.jsx)(n.code,{children:"79233663829379634837589865448569342784712482819484549289560981379859480642508"})})," is the tokenId of ",(0,t.jsx)(n.code,{children:"vitalik.eth"})]}),"\n",(0,t.jsx)(n.h2,{children:"Deriving ENS name from tokenId"}),"\n",(0,t.jsx)(n.p,{children:"Unlike deriving tokenId, deriving ENS name from tokenId is not as easy. This is because all ENS names are stored as fixed-length hash to allow registering infinite length of names. The downside of this architecture is that you cannot directly query ENS smart contracts to return ENS name using tokenId."}),"\n",(0,t.jsxs)(n.p,{children:["Our recommended way is to query via ",(0,t.jsx)(n.a,{href:"https://thegraph.com",children:"https://thegraph.com"})," ENS subgraph. The graph decodes the hash to name as it indexes. The example code to query is as follows."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"const ethers = require('ethers')\nconst BigNumber = ethers.BigNumber\nconst gr = require('graphql-request')\nconst { request, gql } = gr\nconst tokenId = '79233663829379634837589865448569342784712482819484549289560981379859480642508'\n// Should return 0xaf2caa1c2ca1d027f1ac823b529d0a67cd144264b2789fa2ea4d63a67c7103cc\nconst labelHash = BigNumber.from(tokenId).toHexString()\n\nconst url = 'https://api.thegraph.com/subgraphs/name/ensdomains/ens'\nconst GET_LABEL_NAME = gql`\nquery{\n  domains(first:1, where:{labelhash:\"${labelHash}\"}){\n    labelName\n  }\n}`\n\nrequest(url, GET_LABEL_NAME).then((data) => console.log(data))\n// { domains: [ { labelName: 'vitalik' } ] }\n"})}),"\n",(0,t.jsxs)(n.p,{children:["If you prefer not to rely on a third party like TheGraph, the team open-sourced ",(0,t.jsx)(n.a,{href:"https://github.com/graphprotocol/ens-rainbow",children:"ens-rainbow"})," containing a link to the original dataset (6GB with 133 million entities) so that you can host your own ENS name decoding service."]}),"\n",(0,t.jsx)(n.h2,{children:"Turning subdomain into NFT"}),"\n",(0,t.jsxs)(n.p,{children:["Currently, all the subdomains nor non ",(0,t.jsx)(n.code,{children:".eth"})," domains are not NFT, unless the domain registrar itself supports NFT such as (",(0,t.jsx)(n.code,{children:"dcl.eth"}),", and ",(0,t.jsx)(n.code,{children:".kred"}),"). If you want to turn all subdomains which you own, you have to create a registrar"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsx)(n.li,{children:"Create a registrar contract as ERC721 compliant"}),"\n",(0,t.jsx)(n.li,{children:"Set ENS registry address (mostly when you deploy the registrar)"}),"\n",(0,t.jsxs)(n.li,{children:["Create ",(0,t.jsx)(n.code,{children:"register"})," function which calls ",(0,t.jsx)(n.code,{children:"registry.setSubnodeOwner"})," then mint the token making the subdomain label hash as tokenId"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-solidity",children:'contract DCLRegistrar is ERC721Full, Ownable {\n    constructor(\n        IENSRegistry _registry,\n    ) public ERC721Full("DCL Registrar", "DCLENS") {\n        // ENS registry\n        updateRegistry(_registry);\n    }\n\n    function register(\n        string memory _subdomain,\n        bytes32 subdomainLabelHash,\n        address _beneficiary,\n        uint256 _createdDate\n    ) internal {\n        // Create new subdomain and assign the _beneficiary as the owner\n        registry.setSubnodeOwner(domainNameHash, subdomainLabelHash, _beneficiary);\n        // Mint an ERC721 token with the subdomain label hash as its id\n        _mint(_beneficiary, uint256(subdomainLabelHash));\n    }\n}\n'})}),"\n",(0,t.jsx)(n.p,{children:"Once deployed, then you have to transfer the controller address to the contract."}),"\n",(0,t.jsxs)(n.p,{children:["For non-technical users, we are currently working on upgrading our ",(0,t.jsx)(n.code,{children:"SubdomainRegistrar"})," which allows you to turn your subdomain into NFT without any coding."]}),"\n",(0,t.jsx)(n.h2,{children:"Metadata"}),"\n",(0,t.jsxs)(n.p,{children:[".eth does not have ",(0,t.jsx)(n.code,{children:".tokenURI"})," . However, we created a separate metadata service which NFT marketplaces like OpenSea can fetch metadata for ENS such as registration data, expiration date, name length, etc. For more detail, please refer to the metadata documentation site."]}),"\n",(0,t.jsx)("a",{href:"https://metadata.ens.domains/docs",className:"mt-4 block",children:"ENS Metadata Service"})]})}n.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,t.jsx)(i,Object.assign({},e,{children:(0,t.jsx)(c,e)}))}}},function(e){e.O(0,[8164,3248,9774,2888,179],(function(){return n=6048,e(e.s=n);var n}));var n=e.O();_N_E=n}]);