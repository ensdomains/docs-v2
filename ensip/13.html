<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><title>ENSIP-13: SAFE Authentication For ENS - ENS Documentation</title><meta name="description" content="Using ENS Text Records to facilitate safer and more convenient signing operations."/><meta name="next-head-count" content="4"/><script>
  let darkModeMediaQuery = window.matchMedia('(prefers-color-scheme: dark)')

  updateMode()
  darkModeMediaQuery.addEventListener('change', updateModeWithoutTransitions)
  window.addEventListener('storage', updateModeWithoutTransitions)

  function updateMode() {
    let isSystemDarkMode = darkModeMediaQuery.matches
    let isDarkMode = window.localStorage.isDarkMode === 'true' || (!('isDarkMode' in window.localStorage) && isSystemDarkMode)

    if (isDarkMode) {
      document.documentElement.classList.add('dark')
    } else {
      document.documentElement.classList.remove('dark')
    }

    if (isDarkMode === isSystemDarkMode) {
      delete window.localStorage.isDarkMode
    }
  }

  function disableTransitionsTemporarily() {
    document.documentElement.classList.add('[&_*]:!transition-none')
    window.setTimeout(() => {
      document.documentElement.classList.remove('[&_*]:!transition-none')
    }, 0)
  }

  function updateModeWithoutTransitions() {
    disableTransitionsTemporarily()
    updateMode()
  }
</script><meta name="theme-color" content="#5298FF"/><link rel="preload" href="/_next/static/css/e11b0196a5ac107f.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e11b0196a5ac107f.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-cefddfb7403e4fd5.js" defer=""></script><script src="/_next/static/chunks/framework-15c4545a853bb4ff.js" defer=""></script><script src="/_next/static/chunks/main-a664b3180cf41d6f.js" defer=""></script><script src="/_next/static/chunks/pages/_app-f654c8802f325592.js" defer=""></script><script src="/_next/static/chunks/pages/ensip/13-34dc1213dfc45932.js" defer=""></script><script src="/_next/static/cChbVE3qOY-XFyrp2eXgN/_buildManifest.js" defer=""></script><script src="/_next/static/cChbVE3qOY-XFyrp2eXgN/_ssgManifest.js" defer=""></script></head><body class="bg-[#f7f7f7] antialiased dark:bg-zinc-900"><div id="__next"><div class="lg:ml-72 xl:ml-80"><header class="lheader fixed inset-0 top-14 left-0 z-40 contents w-72 overflow-y-auto border-r-0 border-zinc-900/10 px-6 pt-2 pb-8 dark:border-white/10 lg:block xl:w-80"><div class="fixed inset-x-0 top-0 z-50 flex h-14 items-center justify-start gap-6 px-4 transition sm:px-6 lg:z-30 lg:px-4 md:shadow-2xl backdrop-blur-sm dark:backdrop-blur left-0 bg-white/[var(--bg-opacity-light)] dark:bg-zinc-900/[var(--bg-opacity-dark)]" style="--bg-opacity-light:0.5;--bg-opacity-dark:0.2"><div class="absolute hidden md:flex top-full left-0 right-0 text-white px-4 bg-ens-500"><a class="font-bold py-1 px-3 text-xs hover:bg-white/10" href="/">Intro</a><a class="font-bold py-1 px-3 text-xs hover:bg-white/10" href="/web">dApp Developer</a><a class="font-bold py-1 px-3 text-xs hover:bg-white/10" href="/resolvers">Resolution</a><a class="font-bold py-1 px-3 text-xs hover:bg-white/10 bg-black/10" href="/standards">Records &amp; Standardization</a></div><div class="flex items-center gap-5 lg:hidden"><button type="button" class="flex h-6 w-6 items-center justify-center rounded-md transition hover:bg-zinc-900/5 dark:hover:bg-white/5" aria-label="Toggle navigation"><svg viewBox="0 0 10 9" fill="none" stroke-linecap="round" aria-hidden="true" class="w-4 stroke-zinc-900 dark:stroke-white"><path d="M.5 1h9M.5 8h9M.5 4.5h9"></path></svg></button><a aria-label="Home" href="/"><img alt="ENS Logo" src="/_next/static/media/logo.7b7e0018.svg" width="72" height="32" decoding="async" data-nimg="1" class="h-8" loading="lazy" style="color:transparent"/></a></div><div class="hidden lg:flex w-fit"><a aria-label="Home" href="/"><img alt="ENS Logo" src="/_next/static/media/mark.c13fa206.svg" width="32" height="32" decoding="async" data-nimg="1" class="h-8 ml-1 fill-ens-dao-400" loading="lazy" style="color:transparent"/></a></div><div class="absolute inset-x-0 top-full h-px transition bg-zinc-900/7.5 dark:bg-white/7.5"></div><div class="hidden lg:block lg:max-w-md lg:flex-auto"><button type="button" class="hidden h-8 w-full items-center gap-2 rounded-lg bg-white pl-2 pr-3 text-sm text-zinc-500 ring-1 ring-zinc-900/10 transition hover:ring-zinc-900/20 dark:bg-white/5 dark:text-zinc-400 dark:ring-inset dark:ring-white/10 dark:hover:ring-white/20 lg:flex focus:[&amp;:not(:focus-visible)]:outline-none"><svg viewBox="0 0 20 20" fill="none" aria-hidden="true" class="h-5 w-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" d="M12.01 12a4.25 4.25 0 1 0-6.02-6 4.25 4.25 0 0 0 6.02 6Zm0 0 3.24 3.25"></path></svg>Find something...<kbd class="ml-auto text-2xs text-zinc-400 dark:text-zinc-500"><kbd class="font-sans"></kbd><kbd class="font-sans">K</kbd></kbd></button></div><div class="h-full w-auto grow"></div><div class="flex gap-4 items-center"><div class="hidden min-[786px]:flex gap-2"><a target="_blank" class="inline-flex gap-0.5 justify-center overflow-hidden text-sm font-medium transition rounded-lg py-1 px-3 bg-ens-400/10 text-ens-600 ring-1 ring-inset ring-ens-400/20 hover:bg-ens-400/10 hover:text-ens-300 hover:ring-ens-300 dark:bg-ens-400/10 dark:text-ens-400 dark:ring-1 dark:ring-inset dark:ring-ens-400/20 dark:hover:bg-ens-400/10 dark:hover:text-ens-300 dark:hover:ring-ens-300" href="https://app.ens.domains?ref=ens-docs-v2">App</a><a class="inline-flex gap-0.5 justify-center overflow-hidden text-sm font-medium transition rounded-lg py-1 px-3 bg-ens-400/10 text-ens-600 ring-1 ring-inset ring-ens-400/20 hover:bg-ens-400/10 hover:text-ens-300 hover:ring-ens-300 dark:bg-ens-400/10 dark:text-ens-400 dark:ring-1 dark:ring-inset dark:ring-ens-400/20 dark:hover:bg-ens-400/10 dark:hover:text-ens-300 dark:hover:ring-ens-300" href="/dao">DAO Docs</a></div><div class="hidden md:block md:h-5 md:w-px md:bg-zinc-900/10 md:dark:bg-white/15"></div><div class="flex gap-4"><div class="contents lg:hidden"><button type="button" class="flex h-6 w-6 items-center justify-center rounded-md transition hover:bg-zinc-900/5 dark:hover:bg-white/5 lg:hidden focus:[&amp;:not(:focus-visible)]:outline-none" aria-label="Find something..."><svg viewBox="0 0 20 20" fill="none" aria-hidden="true" class="h-5 w-5 stroke-zinc-900 dark:stroke-white"><path stroke-linecap="round" stroke-linejoin="round" d="M12.01 12a4.25 4.25 0 1 0-6.02-6 4.25 4.25 0 0 0 6.02 6Zm0 0 3.24 3.25"></path></svg></button></div><a target="_blank" href="https://github.com/ensdomains/docs-v2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" class="opacity-90 hover:opacity-100" height="1.4rem" width="1.4rem" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></div></div></div><nav class="hidden lg:mt-8 lg:block"><ul><li class="relative mt-6 md:mt-0"><h2 class="text-xs font-semibold text-zinc-900 dark:text-white"></h2><div class="relative mt-3 pl-2"><div class="absolute inset-y-0 left-2 w-px bg-zinc-900/10 dark:bg-white/5"></div><ul class="border-l border-transparent"><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/standards"><span class="truncate flex gap-1 items-center"><span>üëã Welcome</span></span></a></li></ul></div></li><li class="relative mt-6"><h2 class="text-xs font-semibold text-zinc-900 dark:text-white">üíæ Records</h2><div class="relative mt-3 pl-2"><div class="absolute inset-y-0 left-2 w-px bg-zinc-900/10 dark:bg-white/5"></div><ul class="border-l border-transparent"><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/records/quickstart"><span class="truncate flex gap-1 items-center"><span>‚ö° Quickstart</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/records"><span class="truncate flex gap-1 items-center"><span>üíæ Record Types and Standards</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/records/modify"><span class="truncate flex gap-1 items-center"><span>‚úçÔ∏è Modifying Records</span></span></a></li></ul></div></li><li class="relative mt-6"><h2 class="text-xs font-semibold text-zinc-900 dark:text-white">üìñ Improvement Proposals (ENSIPs)</h2><div class="relative mt-3 pl-2"><div class="absolute inset-x-0 top-0 bg-zinc-800/2.5 will-change-transform dark:bg-white/2.5" style="border-radius:8px;height:32px;top:416px;opacity:0"></div><div class="absolute inset-y-0 left-2 w-px bg-zinc-900/10 dark:bg-white/5"></div><div class="absolute left-2 h-6 w-px bg-ens-500" style="top:420px;opacity:1"></div><ul class="border-l border-transparent"><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip"><span class="truncate flex gap-1 items-center"><span>üßë‚Äçüè´ Explained</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/1"><span class="truncate flex gap-1 items-center"><span>1 - ENS</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/2"><span class="truncate flex gap-1 items-center"><span>2 - Hash Registrar</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/3"><span class="truncate flex gap-1 items-center"><span>3 - Reverse Resolution</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/4"><span class="truncate flex gap-1 items-center"><span>4 - Contract ABIs</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/5"><span class="truncate flex gap-1 items-center"><span>5 - Text Records</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/6"><span class="truncate flex gap-1 items-center"><span>6 - DNS-in-ENS</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/7"><span class="truncate flex gap-1 items-center"><span>7 - Contenthash</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/8"><span class="truncate flex gap-1 items-center"><span>8 - Interface Discovery</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/9"><span class="truncate flex gap-1 items-center"><span>9 - Multichain Addresses</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/10"><span class="truncate flex gap-1 items-center"><span>10 - Wildcard Resolution</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/11"><span class="truncate flex gap-1 items-center"><span>11 - EVM Compatible Chain Address</span></span></a></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/12"><span class="truncate flex gap-1 items-center"><span>12 - Avatar Text Records</span></span></a></li><li class="relative"><a aria-current="page" class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-900 dark:text-white" href="/ensip/13"><span class="truncate flex gap-1 items-center"><span>13 - SAFE Authentication</span></span></a><ul role="list" style="opacity:1"><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#abstract"><span class="truncate flex gap-1 items-center">Abstract</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#motivation"><span class="truncate flex gap-1 items-center">Motivation</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#specification"><span class="truncate flex gap-1 items-center">Specification</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#rationale"><span class="truncate flex gap-1 items-center">Rationale</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#reference-implementation"><span class="truncate flex gap-1 items-center">Reference Implementation</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#security-considerations"><span class="truncate flex gap-1 items-center">Security Considerations</span></a></li><li><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-7 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/13#copyright"><span class="truncate flex gap-1 items-center">Copyright</span></a></li></ul></li><li class="relative"><a class="flex justify-between gap-2 py-1 pr-3 text-sm transition pl-4 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-white" href="/ensip/14"><span class="truncate flex gap-1 items-center"><span>14 - On-chain Source Parameter</span></span></a></li></ul></div></li></ul></nav></header><div class="relative px-4 pt-14 sm:px-6 lg:px-8"><main class="py-16"><article class="prose dark:prose-invert"><h1>ENSIP-13: SAFE Authentication For ENS</h1>
<table><thead><tr><th><strong>Author</strong></th><th>Wilkins Chung (@wwhchung), Jalil Wahdatehagh (@jwahdatehagh), Cry (@crydoteth), Sillytuna (@sillytuna), Cyberpnk (@CyberpnkWin)</th></tr></thead><tbody><tr><td><strong>Status</strong></td><td>Draft</td></tr><tr><td><strong>Submitted</strong></td><td>2022-08-03</td></tr></tbody></table>
<h2 id="abstract" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#abstract">Abstract</a><div></div></h2>
<p>This EIP links one or more signing wallets via Ethereum Name Service Specification (<a href="https://eips.ethereum.org/EIPS/eip-137">EIP-137</a>) to prove control and asset ownership of a main wallet.</p>
<h2 id="motivation" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#motivation">Motivation</a><div></div></h2>
<p>Proving ownership of an asset to a third party application in the Ethereum ecosystem is common. Users frequently sign payloads of data to authenticate themselves before gaining access to perform some operation. However, this method--akin to giving the third party root access to one&#x27;s main wallet--is both insecure and inconvenient.</p>
<p><em><strong>Examples:</strong></em></p>
<ol>
<li>In order for you to edit your profile on OpenSea, you must sign a message with your wallet.</li>
<li>In order to access NFT gated content, you must sign a message with the wallet containing the NFT in order to prove ownership.</li>
<li>In order to gain access to an event, you must sign a message with the wallet containing a required NFT in order to prove ownership.</li>
<li>In order to claim an airdrop, you must interact with the smart contract with the qualifying wallet.</li>
<li>In order to prove ownership of an NFT, you must sign a payload with the wallet that owns that NFT.</li>
</ol>
<p>In all the above examples, one interacts with the dApp or smart contract using the wallet itself, which may be</p>
<ul>
<li>inconvenient (if it is controlled via a hardware wallet or a multi-sig)</li>
<li>insecure (since the above operations are read-only, but you are signing/interacting via a wallet that has write access)</li>
</ul>
<p>Instead, one should be able to approve multiple wallets to authenticate on behalf of a given wallet.</p>
<h3>Problems with existing methods and solutions</h3>
<p>Unfortunately, we&#x27;ve seen many cases where users have accidentally signed a malicious payload. The result is almost always a significant loss of assets associated with the signing address.</p>
<p>In addition to this, many users keep significant portions of their assets in &#x27;cold storage&#x27;. With the increased security from &#x27;cold storage&#x27; solutions, we usually see decreased accessibility because users naturally increase the barriers required to access these wallets.</p>
<p>Some solutions propose dedicated registry smart contracts to create this link, or new protocols to be supported. This is problematic from an adoption standpoint, and there have not been any standards created for them.</p>
<h3>Proposal: Use the Ethereum Name Service (EIP-137)</h3>
<p>Rather than &#x27;re-invent the wheel&#x27;, this proposal aims to use the widely adopted Ethereum Name Service in conjunction with the ENS Text Records feature (<a href="https://eips.ethereum.org/EIPS/eip-634">EIP-634</a>) in order to achieve a safer and more convenient way to sign and authenticate, and provide &#x27;read only&#x27; access to a main wallet via one or more secondary wallets.</p>
<p>From there, the benefits are twofold. This EIP gives users increased security via outsourcing potentially malicious signing operations to wallets that are more accessible (hot wallets), while being able to maintain the intended security assumptions of wallets that are not frequently used for signing operations.</p>
<h4>Improving dApp Interaction Security</h4>
<p>Many dApps requires one to prove control of a wallet to gain access. At the moment, this means that you must interact with the dApp using the wallet itself. This is a security issue, as malicious dApps or phishing sites can lead to the assets of the wallet being compromised by having them sign malicious payloads.</p>
<p>However, this risk would be mitigated if one were to use a secondary wallet for these interactions. Malicious interactions would be isolated to the assets held in the secondary wallet, which can be set up to contain little to nothing of value.</p>
<h4>Improving Multiple Device Access Security</h4>
<p>In order for a non-hardware wallet to be used on multiple devices, you must import the seed phrase to each device. Each time a seed phrase is entered on a new device, the risk of the wallet being compromised increases as you are increasing the surface area of devices that have knowledge of the seed phrase.</p>
<p>Instead, each device can have its own unique wallet that is an authorized secondary wallet of the main wallet. If a device specific wallet was ever compromised or lost, you could simply remove the authorization to authenticate.</p>
<p>Further, wallet authentication can be chained so that a secondary wallet could itself authorize one or many tertiary wallets, which then have signing rights for both the secondary address as well as the root main address. This, can allow teams to each have their own signer while the main wallet can easily invalidate an entire tree, just by revoking rights from the root stem.</p>
<h4>Improving Convenience</h4>
<p>Many invididuals use hardware wallets for maximum security. However, this is often inconvenient, since many do not want to carry their hardware wallet with them at all times.</p>
<p>Instead, if you approve a non-hardware wallet for authentication activities (such as a mobile device), you would be able to use most dApps without the need to have your hardware wallet on hand.</p>
<h2 id="specification" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#specification">Specification</a><div></div></h2>
<p>The key words ‚ÄúMUST‚Äù, ‚ÄúMUST NOT‚Äù, ‚ÄúREQUIRED‚Äù, ‚ÄúSHALL‚Äù, ‚ÄúSHALL NOT‚Äù, ‚ÄúSHOULD‚Äù, ‚ÄúSHOULD NOT‚Äù, ‚ÄúRECOMMENDED‚Äù, ‚ÄúMAY‚Äù, and ‚ÄúOPTIONAL‚Äù in this document are to be interpreted as described in RFC 2119.</p>
<p>Let:</p>
<ul>
<li><code>mainAddress</code> represent the wallet address we are trying to authenticate or prove asset ownership for.</li>
<li><code>mainENS</code> represent the reverse lookup ENS string for <code>mainAddress</code>.</li>
<li><code>authAddress</code> represent the address we want to use for signing in lieu of <code>mainAddress</code>.</li>
<li><code>authENS</code> represent the reverse lookup ENS string for <code>authAddress</code>.</li>
<li><code>authKey</code> represents a string in the format <code>[0-9A-Za-z]+</code>.</li>
</ul>
<p>Control of <code>mainAddress</code> and ownership of <code>mainAddress</code> assets by <code>authAddress</code> is proven if all the following conditions are met:</p>
<ul>
<li><code>mainAddress</code> has an ENS resolver record and a reverse record set to <code>mainENS</code>.</li>
<li><code>authAddress</code> has an ENS resolver record and a reverse record set to <code>authENS</code>.</li>
<li><code>authENS</code> has an ENS TEXT record <code>eip5131:vault</code> in the format <code>&lt;authKey&gt;:&lt;mainAddress&gt;</code>.</li>
<li><code>mainENS</code> has an ENS TEXT record <code>eip5131:&lt;authKey&gt;</code>.</li>
</ul>
<h3>Setting up one or many <code>authAddress</code> records on a single ENS domain</h3>
<p>The <code>mainAddress</code> MUST have an ENS resolver record and reverse record configured.
In order to automatically discover the linked account, the <code>authAddress</code> SHOULD have an ENS resolver record and reverse record configured.</p>
<ol>
<li>Choose an unused <code>&lt;authKey&gt;</code>. This can be any string in the format <code>[0-0A-Za-z]+</code>.</li>
<li>Set a TEXT record <code>eip5131:&lt;authKey&gt;</code> on <code>mainENS</code>, with the value set to the desired <code>authAddress</code>.</li>
<li>Set a TEXT record <code>eip5131:vault</code> on <code>authENS</code>, with the value set to the <code>&lt;authKey&gt;:mainAddress</code>.</li>
</ol>
<p>Currently this EIP does not enforce an upper-bound on the number of <code>authAddress</code> entries you can include. Users can repeat this process with as many address as they like.</p>
<h3>Authenticating <code>mainAddress</code> via <code>authAddress</code></h3>
<p>Control of <code>mainAddress</code> and ownership of <code>mainAddress</code> assets is proven if any associated <code>authAddress</code> is the <code>msg.sender</code> or has signed the message.</p>
<p>Practically, this would work by performing the following operations:</p>
<ol>
<li>Get the resolver for <code>authENS</code></li>
<li>Get the <code>eip5131:vault</code> TEXT record of <code>authENS</code></li>
<li>Parse <code>&lt;authKey&gt;:&lt;mainAddress&gt;</code> to determine the <code>authKey</code> and <code>mainAddress</code>.</li>
<li>MUST get the reverse ENS record for <code>mainAddress</code> and verify that it matches <code>&lt;mainENS&gt;</code>.<!-- -->
<ul>
<li>Otherwise one could set up other ENS nodes (with auths) that point to <code>mainAddress</code> and authenticate via those.</li>
</ul>
</li>
<li>Get the <code>eip5131:&lt;authKey&gt;</code> TEXT record of <code>mainENS</code> and ensure it matches <code>authAddress</code>.</li>
</ol>
<p>Note that this specification allows for both contract level and client/server side validation of signatures.  It is not limited to smart contracts, which is why there is no proposed external interface definition.</p>
<h3>Revocation of <code>authAddress</code></h3>
<p>To revoke permission of <code>authAddress</code>, delete the <code>eip5131:&lt;authKey&gt;</code> TEXT record of <code>mainENS</code> or update it to point to a new <code>authAddress</code>.</p>
<h2 id="rationale" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#rationale">Rationale</a><div></div></h2>
<h3>Usage of EIP-137</h3>
<p>The proposed specification makes use of EIP-137 rather than introduce another registry paradigm. The reason for this is due to the existing wide adoption of EIP-137 and ENS.</p>
<p>However, the drawback to EIP-137 is that any linked <code>authAddress</code> must contain some ETH in order to set the <code>authENS</code> reverse record as well as the <code>eip5131:vault</code> TEXT record. This can be solved by a separate reverse lookup registry that enables <code>mainAddress</code> to set the reverse record and TEXT record with a message signed by <code>authAddress</code>.</p>
<p>With the advent of L2s and ENS Layer 2 functionalities, off chain verification of linked addresses is possible even with domains managed across different chains.</p>
<h3>One-to-Many Authentication Relationship</h3>
<p>This proposed specification allows for a one (<code>mainAddress</code>) to many (<code>authAddress</code>) authentication relationship.  i.e. one <code>mainAddress</code> can authorize many <code>authAddress</code> to authenticate, but an <code>authAddress</code> can only authenticate itself or a single <code>mainAddress</code>.</p>
<p>The reason for this design choice is to allow for simplicity of authentication via client and smart contract code. You can determine which <code>mainAddress</code> the <code>authAddress</code> is signing for without any additional user input.</p>
<p>Further, you can design UX without any user interaction necessary to &#x27;pick&#x27; the interacting address by display assets owned by <code>authAddress</code> and <code>mainAddress</code> and use the appropriate address dependent on the asset the user is attempting to authenticate with.</p>
<h2 id="reference-implementation" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#reference-implementation">Reference Implementation</a><div></div></h2>
<h3>Client/Server Side</h3>
<p>In typescript, the validation function, using ethers.js would be as follows:</p>
<div class="not-prose my-6 overflow-hidden rounded-lg bg-[--var(--shiki-color-background)] shadow-sm dark:shadow-md ring-1 ring-black/10 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-black"><code class="language-solidity"><span><span style="color: var(--shiki-color-text)">export </span><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-token-function)"> LinkedAddress</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">  ens</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">export async </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getLinkedAddress</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">  provider: ethers.</span><span style="color: var(--shiki-token-constant)">providers</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">EnsProvider</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">: </span><span style="color: var(--shiki-token-constant)">string</span></span>
<span><span style="color: var(--shiki-color-text)">): </span><span style="color: var(--shiki-token-function)">Promise</span><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-function)">LinkedAddress</span><span style="color: var(--shiki-color-text)"> | </span><span style="color: var(--shiki-token-function)">null</span><span style="color: var(--shiki-color-text)">&gt; {</span></span>
<span><span style="color: var(--shiki-color-text)">  const addressENS </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> await provider.</span><span style="color: var(--shiki-token-function)">lookupAddress</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">!</span><span style="color: var(--shiki-color-text)">addressENS) </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> null;</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  const vaultInfo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">await</span><span style="color: var(--shiki-color-text)"> (await provider.</span><span style="color: var(--shiki-token-function)">getResolver</span><span style="color: var(--shiki-color-text)">(addressENS))</span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">getText</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;eip5131:vault&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">!</span><span style="color: var(--shiki-color-text)">vaultInfo) </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> null;</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  const vaultInfoArray </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> vaultInfo.</span><span style="color: var(--shiki-token-function)">split</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;:&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (vaultInfoArray.length </span><span style="color: var(--shiki-token-keyword)">!==</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">) {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">throw</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Error</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;EIP5131: Authkey and vault address not configured correctly.&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">  }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  const [ authKey</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> vaultAddress ] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> vaultInfoArray;</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  const vaultENS </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> await provider.</span><span style="color: var(--shiki-token-function)">lookupAddress</span><span style="color: var(--shiki-color-text)">(vaultAddress);</span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">!</span><span style="color: var(--shiki-color-text)">vaultENS) {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">throw</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Error</span><span style="color: var(--shiki-color-text)">(`EIP5131</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> No ENS domain with reverse record set </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> vault.`);</span></span>
<span><span style="color: var(--shiki-color-text)">  };</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  const expectedSigningAddress </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">await</span><span style="color: var(--shiki-color-text)"> (</span></span>
<span><span style="color: var(--shiki-color-text)">    await provider.</span><span style="color: var(--shiki-token-function)">getResolver</span><span style="color: var(--shiki-color-text)">(vaultENS)</span></span>
<span><span style="color: var(--shiki-color-text)">  )</span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">getText</span><span style="color: var(--shiki-color-text)">(`eip5131</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)">${authKey}`);</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (expectedSigningAddress</span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">toLowerCase</span><span style="color: var(--shiki-color-text)">() </span><span style="color: var(--shiki-token-keyword)">!==</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-function)">toLowerCase</span><span style="color: var(--shiki-color-text)">()) {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">throw</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Error</span><span style="color: var(--shiki-color-text)">(`EIP5131</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> Authentication mismatch.`);</span></span>
<span><span style="color: var(--shiki-color-text)">  };</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">    ens</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> vaultENS</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> vaultAddress</span></span>
<span><span style="color: var(--shiki-color-text)">  };</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span></code></pre><button type="button" class="group/button absolute top-3.5 right-4 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-ens-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<h3>Contract side</h3>
<h4>With a backend</h4>
<p>If your application operates a secure backend server, you could run the client/server code above, then use the result in conjunction with specs like <a href="https://eips.ethereum.org/EIPS/eip-1271">EIP-1271</a> : <code>Standard Signature Validation Method for Contracts</code> for a cheap and secure way to validate that the the message signer is indeed authenticated for the main address.</p>
<h4>Without a backend (JavaScript only)</h4>
<p>Provided is a reference implementation for an internal function to verify that the message sender has an authentication link to the main address.</p>
<div class="not-prose my-6 overflow-hidden rounded-lg bg-[--var(--shiki-color-background)] shadow-sm dark:shadow-md ring-1 ring-black/10 dark:ring-white/10"><div class="group dark:bg-white/2.5"><div class="relative"><pre class="overflow-x-auto p-4 text-xs text-black"><code class="language-solidity"><span><span style="color: var(--shiki-token-comment)">// SPDX-License-Identifier: MIT</span></span>
<span></span>
<span><span style="color: var(--shiki-token-keyword)">pragma</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">solidity</span><span style="color: var(--shiki-color-text)"> ^0.8.0;</span></span>
<span></span>
<span><span style="color: var(--shiki-token-comment)">/// </span><span style="color: var(--shiki-token-keyword)">@author</span><span style="color: var(--shiki-token-comment)">: manifold.xyz</span></span>
<span></span>
<span><span style="color: var(--shiki-token-comment)">/**</span></span>
<span><span style="color: var(--shiki-token-comment)"> * ENS Registry Interface</span></span>
<span><span style="color: var(--shiki-token-comment)"> */</span></span>
<span><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-token-function)"> ENS</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">resolver</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> node) </span><span style="color: var(--shiki-token-keyword)">external</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span>
<span><span style="color: var(--shiki-token-comment)">/**</span></span>
<span><span style="color: var(--shiki-token-comment)"> * ENS Resolver Interface</span></span>
<span><span style="color: var(--shiki-token-comment)"> */</span></span>
<span><span style="color: var(--shiki-token-keyword)">interface</span><span style="color: var(--shiki-token-function)"> Resolver</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">addr</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> node) </span><span style="color: var(--shiki-token-keyword)">external</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">name</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> node) </span><span style="color: var(--shiki-token-keyword)">external</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">text</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> node</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">calldata</span><span style="color: var(--shiki-color-text)"> key) </span><span style="color: var(--shiki-token-keyword)">external</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span>
<span><span style="color: var(--shiki-token-comment)">/**</span></span>
<span><span style="color: var(--shiki-token-comment)"> * Validate a signing address is associtaed with a linked address</span></span>
<span><span style="color: var(--shiki-token-comment)"> */</span></span>
<span><span style="color: var(--shiki-token-keyword)">library</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">LinkedAddress</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">/**</span></span>
<span><span style="color: var(--shiki-token-comment)">     * Validate that the message sender is an authentication address for mainAddress</span></span>
<span><span style="color: var(--shiki-token-comment)">     *</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> ensRegistry    Address of ENS registry</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> mainAddress     The main address we want to authenticate for.</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> mainENSNodeHash The main ENS Node Hash</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> authKey         The TEXT record of the authKey we are using for validation</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> authENSNodeHash The auth ENS Node Hash</span></span>
<span><span style="color: var(--shiki-token-comment)">     */</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">validateSender</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> mainENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">calldata</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> authENSNodeHash</span></span>
<span><span style="color: var(--shiki-color-text)">    ) </span><span style="color: var(--shiki-token-keyword)">internal</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">bool</span><span style="color: var(--shiki-color-text)">) {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">validate</span><span style="color: var(--shiki-color-text)">(ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> mainENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> msg.sender</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authENSNodeHash);</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">/**</span></span>
<span><span style="color: var(--shiki-token-comment)">     * Validate that the authAddress is an authentication address for mainAddress</span></span>
<span><span style="color: var(--shiki-token-comment)">     *</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> ensRegistry     Address of ENS registry</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> mainAddress     The main address we want to authenticate for.</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> mainENSNodeHash The main ENS Node Hash</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> authAddress     The address of the authentication wallet</span></span>
<span><span style="color: var(--shiki-token-comment)">     * </span><span style="color: var(--shiki-token-keyword)">@param</span><span style="color: var(--shiki-token-comment)"> authENSNodeHash The auth ENS Node Hash</span></span>
<span><span style="color: var(--shiki-token-comment)">     */</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">validate</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> mainENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">calldata</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> authAddress</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> authENSNodeHash</span></span>
<span><span style="color: var(--shiki-color-text)">    ) </span><span style="color: var(--shiki-token-keyword)">internal</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">bool</span><span style="color: var(--shiki-color-text)">) {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-function)">_verifyMainENS</span><span style="color: var(--shiki-color-text)">(ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> mainENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authAddress);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-function)">_verifyAuthENS</span><span style="color: var(--shiki-color-text)">(ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authAddress</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authENSNodeHash);</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-color-text)">;</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// *********************</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">//   Helper Functions</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// *********************</span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">_verifyMainENS</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> mainENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">calldata</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> authAddress</span></span>
<span><span style="color: var(--shiki-color-text)">    ) </span><span style="color: var(--shiki-token-keyword)">private</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// Check if the ENS nodes resolve correctly to the provided addresses</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> mainResolver </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">ENS</span><span style="color: var(--shiki-color-text)">(ensRegistry).</span><span style="color: var(--shiki-token-function)">resolver</span><span style="color: var(--shiki-color-text)">(mainENSNodeHash);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">require</span><span style="color: var(--shiki-color-text)">(mainResolver </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;Main ENS not registered&quot;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">require</span><span style="color: var(--shiki-color-text)">(mainAddress </span><span style="color: var(--shiki-token-keyword)">==</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Resolver</span><span style="color: var(--shiki-color-text)">(mainResolver).</span><span style="color: var(--shiki-token-function)">addr</span><span style="color: var(--shiki-color-text)">(mainENSNodeHash)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;Main address is wrong&quot;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// Verify the authKey TEXT record is set to authAddress by mainENS</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)"> authText </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Resolver</span><span style="color: var(--shiki-color-text)">(mainResolver).</span><span style="color: var(--shiki-token-function)">text</span><span style="color: var(--shiki-color-text)">(mainENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">(abi.</span><span style="color: var(--shiki-token-function)">encodePacked</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;eip5131:&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> authKey)));</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">require</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-function)">keccak256</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes</span><span style="color: var(--shiki-color-text)">(authText)) </span><span style="color: var(--shiki-token-keyword)">==</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">keccak256</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">_addressToString</span><span style="color: var(--shiki-color-text)">(authAddress)))</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-string-expression)">&quot;Invalid auth address&quot;</span></span>
<span><span style="color: var(--shiki-color-text)">        );</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">_verifyAuthENS</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> ensRegistry</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> mainAddress</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)"> authKey</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> authAddress</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> authENSNodeHash</span></span>
<span><span style="color: var(--shiki-color-text)">    ) </span><span style="color: var(--shiki-token-keyword)">private</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">view</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// Check if the ENS nodes resolve correctly to the provided addresses</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> authResolver </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">ENS</span><span style="color: var(--shiki-color-text)">(ensRegistry).</span><span style="color: var(--shiki-token-function)">resolver</span><span style="color: var(--shiki-color-text)">(authENSNodeHash);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">require</span><span style="color: var(--shiki-color-text)">(authResolver </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;Auth ENS not registered&quot;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">require</span><span style="color: var(--shiki-color-text)">(authAddress </span><span style="color: var(--shiki-token-keyword)">==</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Resolver</span><span style="color: var(--shiki-color-text)">(authResolver).</span><span style="color: var(--shiki-token-function)">addr</span><span style="color: var(--shiki-color-text)">(authENSNodeHash)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;Auth address is wrong&quot;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// Verify the TEXT record is appropriately set by authENS</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)"> vaultText </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Resolver</span><span style="color: var(--shiki-color-text)">(authResolver).</span><span style="color: var(--shiki-token-function)">text</span><span style="color: var(--shiki-color-text)">(authENSNodeHash</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;eip5131:vault&quot;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">require</span><span style="color: var(--shiki-color-text)">(</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-function)">keccak256</span><span style="color: var(--shiki-color-text)">(abi.</span><span style="color: var(--shiki-token-function)">encodePacked</span><span style="color: var(--shiki-color-text)">(authKey</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;:&quot;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">_addressToString</span><span style="color: var(--shiki-color-text)">(mainAddress))) </span><span style="color: var(--shiki-token-keyword)">==</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-function)">keccak256</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">bytes</span><span style="color: var(--shiki-color-text)">(vaultText))</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-string-expression)">&quot;Invalid auth text record&quot;</span></span>
<span><span style="color: var(--shiki-color-text)">        );</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">bytes16</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">private</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">constant</span><span style="color: var(--shiki-color-text)"> _HEX_SYMBOLS </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;0123456789abcdef&quot;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">sha3HexAddress</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> addr) </span><span style="color: var(--shiki-token-keyword)">private</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">pure</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">bytes32</span><span style="color: var(--shiki-color-text)"> ret) {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">uint256</span><span style="color: var(--shiki-color-text)"> value </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">uint256</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">uint160</span><span style="color: var(--shiki-color-text)">(addr));</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">bytes</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)"> buffer </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">bytes</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">40</span><span style="color: var(--shiki-color-text)">);</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">uint256</span><span style="color: var(--shiki-color-text)"> i </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">39</span><span style="color: var(--shiki-color-text)">; i </span><span style="color: var(--shiki-token-keyword)">&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-keyword)">--</span><span style="color: var(--shiki-color-text)">i) {</span></span>
<span><span style="color: var(--shiki-color-text)">            buffer[i] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> _HEX_SYMBOLS[value </span><span style="color: var(--shiki-token-keyword)">&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0xf</span><span style="color: var(--shiki-color-text)">];</span></span>
<span><span style="color: var(--shiki-color-text)">            value </span><span style="color: var(--shiki-token-keyword)">&gt;&gt;=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">;</span></span>
<span><span style="color: var(--shiki-color-text)">        }</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">keccak256</span><span style="color: var(--shiki-color-text)">(buffer);</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">_addressToString</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">address</span><span style="color: var(--shiki-color-text)"> addr) </span><span style="color: var(--shiki-token-keyword)">private</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">pure</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">returns</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">memory</span><span style="color: var(--shiki-color-text)"> ptr) {</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-comment)">// </span><span style="color: var(--shiki-token-keyword)">solhint-disable</span><span style="color: var(--shiki-token-comment)">-next-line no-inline-assembly</span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">assembly</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">            ptr </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">mload</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0x40</span><span style="color: var(--shiki-color-text)">)</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// Adjust mem ptr and keep 32 byte aligned</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// 32 bytes to store string length; address is 42 bytes long</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-function)">mstore</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0x40</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">add</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">96</span><span style="color: var(--shiki-color-text)">))</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// Store (string length, &#39;0&#39;, &#39;x&#39;) (42, 48, 120)</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// Single write by offsetting across 32 byte boundary</span></span>
<span><span style="color: var(--shiki-color-text)">            ptr </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">add</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-function)">mstore</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0x2a3078</span><span style="color: var(--shiki-color-text)">)</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// Write string backwards</span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> {</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// end is at &#39;x&#39;, ptr is at lsb char</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-keyword)">let</span><span style="color: var(--shiki-color-text)"> end </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">add</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">31</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">                ptr </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">add</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">71</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">            } </span><span style="color: var(--shiki-token-function)">gt</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> end) {</span></span>
<span><span style="color: var(--shiki-color-text)">                ptr </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">sub</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">                addr </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">shr</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> addr)</span></span>
<span><span style="color: var(--shiki-color-text)">            } {</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-keyword)">let</span><span style="color: var(--shiki-color-text)"> v </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">and</span><span style="color: var(--shiki-color-text)">(addr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0xf</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// if &gt; 9, use ascii &#39;a-f&#39; (no conditional required)</span></span>
<span><span style="color: var(--shiki-color-text)">                v </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">add</span><span style="color: var(--shiki-color-text)">(v</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">mul</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-function)">gt</span><span style="color: var(--shiki-color-text)">(v</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">9</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">39</span><span style="color: var(--shiki-color-text)">))</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-comment)">// Add ascii for &#39;0&#39;</span></span>
<span><span style="color: var(--shiki-color-text)">                v </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">add</span><span style="color: var(--shiki-color-text)">(v</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">48</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">                </span><span style="color: var(--shiki-token-function)">mstore8</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> v)</span></span>
<span><span style="color: var(--shiki-color-text)">            }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">            </span><span style="color: var(--shiki-token-comment)">// return ptr to point to length (32 + 2 for &#39;0x&#39; - 1)</span></span>
<span><span style="color: var(--shiki-color-text)">            ptr </span><span style="color: var(--shiki-token-keyword)">:=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">sub</span><span style="color: var(--shiki-color-text)">(ptr</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">33</span><span style="color: var(--shiki-color-text)">)</span></span>
<span><span style="color: var(--shiki-color-text)">        }</span></span>
<span></span>
<span><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">string</span><span style="color: var(--shiki-color-text)">(ptr);</span></span>
<span><span style="color: var(--shiki-color-text)">    }</span></span>
<span><span style="color: var(--shiki-color-text)">}</span></span>
<span></span></code></pre><button type="button" class="group/button absolute top-3.5 right-4 overflow-hidden rounded-full py-1 pl-2 pr-3 text-2xs font-medium opacity-0 backdrop-blur transition focus:opacity-100 group-hover:opacity-100 bg-white/5 hover:bg-white/7.5 dark:bg-white/2.5 dark:hover:bg-white/5"><span aria-hidden="false" class="pointer-events-none flex items-center gap-0.5 text-zinc-400 transition duration-300"><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-500/20 stroke-zinc-500 transition-colors group-hover/button:stroke-zinc-400"><path stroke-width="0" d="M5.5 13.5v-5a2 2 0 0 1 2-2l.447-.894A2 2 0 0 1 9.737 4.5h.527a2 2 0 0 1 1.789 1.106l.447.894a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2Z"></path><path fill="none" stroke-linejoin="round" d="M12.5 6.5a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-5a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2m5 0-.447-.894a2 2 0 0 0-1.79-1.106h-.527a2 2 0 0 0-1.789 1.106L7.5 6.5m5 0-1 1h-3l-1-1"></path></svg>Copy</span><span aria-hidden="true" class="pointer-events-none absolute inset-0 flex items-center justify-center text-ens-400 transition duration-300 translate-y-1.5 opacity-0">Copied!</span></button></div></div></div>
<h2 id="security-considerations" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#security-considerations">Security Considerations</a><div></div></h2>
<p>The core purpose of this EIP is to enhance security and promote a safer way to authenticate wallet control and asset ownership when the main wallet is not needed and assets held by the main wallet do not need to be moved. Consider it a way to do &#x27;read only&#x27; authentication.</p>
<h2 id="copyright" class="mt-8 scroll-mt-32 flex justify-between items-center w-full"><a class="group text-inherit no-underline hover:text-inherit" href="/ensip/13#copyright">Copyright</a><div></div></h2>
<p>Copyright and related rights waived via <a href="/LICENSE.md">CC0</a>.</p></article></main><footer class="mx-auto max-w-2xl space-y-10 pb-16 lg:max-w-5xl"><div class="relative h-8"><form class="absolute inset-0 flex items-center justify-center gap-6 md:justify-start"><p class="text-sm text-zinc-600 dark:text-zinc-400">Was this page helpful?</p><div class="group grid h-8 grid-cols-[1fr,1px,1fr] overflow-hidden rounded-full border border-zinc-900/10 dark:border-white/10"><button type="submit" class="px-3 text-sm font-medium text-zinc-600 transition hover:bg-zinc-900/2.5 hover:text-zinc-900 dark:text-zinc-400 dark:hover:bg-white/5 dark:hover:text-white" data-response="yes">Yes</button><div class="bg-zinc-900/10 dark:bg-white/10"></div><button type="submit" class="px-3 text-sm font-medium text-zinc-600 transition hover:bg-zinc-900/2.5 hover:text-zinc-900 dark:text-zinc-400 dark:hover:bg-white/5 dark:hover:text-white" data-response="no">No</button></div></form></div><div class="flex"><div class="flex flex-col items-start gap-3"><a class="inline-flex gap-0.5 justify-center overflow-hidden text-sm font-medium transition rounded-lg bg-zinc-100 py-1 px-3 text-zinc-900 hover:bg-zinc-200 dark:bg-zinc-800/40 dark:text-zinc-400 dark:ring-1 dark:ring-inset dark:ring-zinc-800 dark:hover:bg-zinc-800 dark:hover:text-zinc-300" aria-label="Previous: 12 - Avatar Text Records" href="/ensip/12"><svg viewBox="0 0 20 20" fill="none" aria-hidden="true" class="mt-0.5 h-5 w-5 -ml-1 rotate-180"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="m11.5 6.5 3 3.5m0 0-3 3.5m3-3.5h-9"></path></svg>Previous</a><a tabindex="-1" aria-hidden="true" class="text-base font-semibold text-zinc-900 transition hover:text-zinc-600 dark:text-white dark:hover:text-zinc-300" href="/ensip/12">12 - Avatar Text Records</a></div><div class="ml-auto flex flex-col items-end gap-3"><a class="inline-flex gap-0.5 justify-center overflow-hidden text-sm font-medium transition rounded-lg bg-zinc-100 py-1 px-3 text-zinc-900 hover:bg-zinc-200 dark:bg-zinc-800/40 dark:text-zinc-400 dark:ring-1 dark:ring-inset dark:ring-zinc-800 dark:hover:bg-zinc-800 dark:hover:text-zinc-300" aria-label="Next: 14 - On-chain Source Parameter" href="/ensip/14">Next<svg viewBox="0 0 20 20" fill="none" aria-hidden="true" class="mt-0.5 h-5 w-5 -mr-1"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="m11.5 6.5 3 3.5m0 0-3 3.5m3-3.5h-9"></path></svg></a><a tabindex="-1" aria-hidden="true" class="text-base font-semibold text-zinc-900 transition hover:text-zinc-600 dark:text-white dark:hover:text-zinc-300" href="/ensip/14">14 - On-chain Source Parameter</a></div></div><div class="flex flex-col items-center justify-between gap-5 border-t border-zinc-900/5 pt-8 dark:border-white/5 sm:flex-row"><p class="text-xs text-zinc-600 dark:text-zinc-400">¬© Copyright <!-- -->2023<!-- -->. All rights reserved.</p><div class="flex gap-4"><a class="group" href="/ensip/13#"><span class="sr-only">Follow us on Twitter</span><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-700 transition group-hover:fill-zinc-900 dark:group-hover:fill-zinc-500"><path d="M16.712 6.652c.01.146.01.29.01.436 0 4.449-3.267 9.579-9.242 9.579v-.003a8.963 8.963 0 0 1-4.98-1.509 6.379 6.379 0 0 0 4.807-1.396c-1.39-.027-2.608-.966-3.035-2.337.487.097.99.077 1.467-.059-1.514-.316-2.606-1.696-2.606-3.3v-.041c.45.26.956.404 1.475.42C3.18 7.454 2.74 5.486 3.602 3.947c1.65 2.104 4.083 3.382 6.695 3.517a3.446 3.446 0 0 1 .94-3.217 3.172 3.172 0 0 1 4.596.148 6.38 6.38 0 0 0 2.063-.817 3.357 3.357 0 0 1-1.428 1.861 6.283 6.283 0 0 0 1.865-.53 6.735 6.735 0 0 1-1.62 1.744Z"></path></svg></a><a class="group" href="/ensip/13#"><span class="sr-only">Follow us on GitHub</span><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-700 transition group-hover:fill-zinc-900 dark:group-hover:fill-zinc-500"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 1.667c-4.605 0-8.334 3.823-8.334 8.544 0 3.78 2.385 6.974 5.698 8.106.417.075.573-.182.573-.406 0-.203-.011-.875-.011-1.592-2.093.397-2.635-.522-2.802-1.002-.094-.246-.5-1.005-.854-1.207-.291-.16-.708-.556-.01-.567.656-.01 1.124.62 1.281.876.75 1.292 1.948.93 2.427.705.073-.555.291-.93.531-1.143-1.854-.213-3.791-.95-3.791-4.218 0-.929.322-1.698.854-2.296-.083-.214-.375-1.09.083-2.265 0 0 .698-.224 2.292.876a7.576 7.576 0 0 1 2.083-.288c.709 0 1.417.096 2.084.288 1.593-1.11 2.291-.875 2.291-.875.459 1.174.167 2.05.084 2.263.53.599.854 1.357.854 2.297 0 3.278-1.948 4.005-3.802 4.219.302.266.563.78.563 1.58 0 1.143-.011 2.061-.011 2.35 0 .224.156.491.573.405a8.365 8.365 0 0 0 4.11-3.116 8.707 8.707 0 0 0 1.567-4.99c0-4.721-3.73-8.545-8.334-8.545Z"></path></svg></a><a class="group" href="/ensip/13#"><span class="sr-only">Join our Discord server</span><svg viewBox="0 0 20 20" aria-hidden="true" class="h-5 w-5 fill-zinc-700 transition group-hover:fill-zinc-900 dark:group-hover:fill-zinc-500"><path d="M16.238 4.515a14.842 14.842 0 0 0-3.664-1.136.055.055 0 0 0-.059.027 10.35 10.35 0 0 0-.456.938 13.702 13.702 0 0 0-4.115 0 9.479 9.479 0 0 0-.464-.938.058.058 0 0 0-.058-.027c-1.266.218-2.497.6-3.664 1.136a.052.052 0 0 0-.024.02C1.4 8.023.76 11.424 1.074 14.782a.062.062 0 0 0 .024.042 14.923 14.923 0 0 0 4.494 2.272.058.058 0 0 0 .064-.02c.346-.473.654-.972.92-1.496a.057.057 0 0 0-.032-.08 9.83 9.83 0 0 1-1.404-.669.058.058 0 0 1-.029-.046.058.058 0 0 1 .023-.05c.094-.07.189-.144.279-.218a.056.056 0 0 1 .058-.008c2.946 1.345 6.135 1.345 9.046 0a.056.056 0 0 1 .059.007c.09.074.184.149.28.22a.058.058 0 0 1 .023.049.059.059 0 0 1-.028.046 9.224 9.224 0 0 1-1.405.669.058.058 0 0 0-.033.033.056.056 0 0 0 .002.047c.27.523.58 1.022.92 1.495a.056.056 0 0 0 .062.021 14.878 14.878 0 0 0 4.502-2.272.055.055 0 0 0 .016-.018.056.056 0 0 0 .008-.023c.375-3.883-.63-7.256-2.662-10.246a.046.046 0 0 0-.023-.021Zm-9.223 8.221c-.887 0-1.618-.814-1.618-1.814s.717-1.814 1.618-1.814c.908 0 1.632.821 1.618 1.814 0 1-.717 1.814-1.618 1.814Zm5.981 0c-.887 0-1.618-.814-1.618-1.814s.717-1.814 1.618-1.814c.908 0 1.632.821 1.618 1.814 0 1-.71 1.814-1.618 1.814Z"></path></svg></a></div></div></footer></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"description":"Using ENS Text Records to facilitate safer and more convenient signing operations.","sections":[{"title":"Abstract","navtitle":"","id":"abstract"},{"title":"Motivation","navtitle":"","id":"motivation"},{"title":"Specification","navtitle":"","id":"specification"},{"title":"Rationale","navtitle":"","id":"rationale"},{"title":"Reference Implementation","navtitle":"","id":"reference-implementation"},{"title":"Security Considerations","navtitle":"","id":"security-considerations"},{"title":"Copyright","navtitle":"","id":"copyright"}],"title":"ENSIP-13: SAFE Authentication For ENS"},"__N_SSG":true},"page":"/ensip/13","query":{},"buildId":"cChbVE3qOY-XFyrp2eXgN","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>